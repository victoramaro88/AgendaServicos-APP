<app-menu></app-menu>

<div *ngIf="boolLoading" class="text-center">
  <p-progressBar mode="indeterminate"></p-progressBar>
  <b><p>CARREGANDO...</p></b>
</div>
<p-blockUI [blocked]="boolLoading"></p-blockUI>
<p-toast  position="top-center"></p-toast>

<h1>Eventos Concluídos</h1>

<!-- LISTANDO NA GRID -->
<div *ngIf="listaEvento.length === 0" class="text-center"><p><b>{{mensagemTela}}</b></p></div>
<div *ngIf="!modoEdicao && listaEvento.length > 0">
  <p-table #dt1
  [value]="listaEvento"
  styleClass="p-datatable-striped p-datatable-sm"
  [paginator]="true" [rows]="10"
  [globalFilterFields]="['eventDesc', 'cidaDesc', 'maqMarca', 'usuNome', 'eventLogr', 'eventBairr', 'tipChLiDesc']"
  >
  <ng-template pTemplate="caption">
    <div class="p-d-flex text-right">
      <span class="p-input-icon-left p-ml-auto">
        <i class="pi pi-search"></i>
        <input #Filtro pInputText type="text" (input)="dt1.filterGlobal(Filtro.value, 'contains')" placeholder="Pesquisa Global" class="p-inputtext-sm"/>
      </span>
    </div>
  </ng-template>
  <ng-template pTemplate="header">
    <tr>
      <th pSortableColumn="eventDesc">Descrição <p-sortIcon field="eventDesc"></p-sortIcon></th>
      <th pSortableColumn="tipChLiDesc">Tipo Furo <p-sortIcon field="tipChLiDesc"></p-sortIcon></th>
      <th pSortableColumn="eventLogr">Endereço <p-sortIcon field="eventLogr"></p-sortIcon></th>
      <th pSortableColumn="eventLogr">Bairro <p-sortIcon field="eventBairr"></p-sortIcon></th>
      <th pSortableColumn="eventDtIn">Período <p-sortIcon field="eventDtIn"></p-sortIcon></th>
      <th pSortableColumn="usuNome">Responsável <p-sortIcon field="usuNome"></p-sortIcon></th>
      <th pSortableColumn="maqMarca">Máquina <p-sortIcon field="maqMarca"></p-sortIcon></th>
      <th pSortableColumn="eventStatus">Status <p-sortIcon field="eventStatus"></p-sortIcon></th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-item>
    <!-- <tr [style.background-color]="item.eventStatus === 3 ? '#ffd1d1'
      : item.eventStatus === 2
      ? '#fff9bd'
      : item.eventStatus === 4
      ? '#d6e0ff' : 'transparent'"
      > -->
      <tr>
        <td pTooltip="{{item.eventDesc}}" tooltipPosition="top"><span class="p-column-title"><b>Descrição</b></span><small>{{item.eventDesc}}</small></td>
        <td pTooltip="{{item.tipChLiDesc}}" tooltipPosition="top"><span class="p-column-title"><b>Tipo Furo</b></span><small>{{item.tipChLiDesc}}</small></td>
        <td pTooltip="{{item.eventLogr}}" tooltipPosition="top"><span class="p-column-title"><b>Endereço</b></span><small>{{item.eventLogr.substring(0, 20)}}...</small></td>
        <td pTooltip="{{item.eventBairr}}" tooltipPosition="top"><span class="p-column-title"><b>Bairro</b></span><small>{{item.eventBairr.substring(0, 20)}}...</small></td>
        <td pTooltip="{{item.eventDtIn | date: 'dd/MM/yyyy'}} a {{item.evenDtFi | date: 'dd/MM/yyyy'}}" tooltipPosition="top"><span class="p-column-title"><b>Período</b></span><small>{{item.eventDtIn | date: 'dd/MM/yyyy'}} a {{item.evenDtFi | date: 'dd/MM/yyyy'}}</small></td>
        <td pTooltip="{{item.usuNome}}" tooltipPosition="top"><span class="p-column-title"><b>Responsável</b></span><small>{{item.usuNome.substring(0, 10)}}...</small></td>
        <td pTooltip="{{item.maqMarca}}" tooltipPosition="top"><span class="p-column-title"><b>Máquina</b></span><small>{{item.maqMarca.substring(0, 10)}}...</small></td>
        <td><span class="p-column-title"><b>Status</b></span>
          <p-tag severity="{{item.eventStatus === 9 ? 'success'
          : item.eventStatus === 2 ? 'warning' : item.eventStatus === 4 ? 'info' : 'success'}}"
          value="{{item.eventStatus === 9 ? 'Concluído'
          : item.eventStatus === 2 ? '' : item.eventStatus === 4 ? 'Reagendado' : 'Aguardando'}}"></p-tag>
        </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
      <tr>
        <td style="text-align: center;" colspan="9">Sem informações.</td>
      </tr>
    </ng-template>
  </p-table>
</div>
